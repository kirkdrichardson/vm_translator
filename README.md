# VM Translator
The backend of a two-tier compiler for the Jack programming langauge targeting the Hack platform. [See this repo](https://github.com/kirkdrichardson/jackc) for the frontend of the compiler.

This project is a Dart implementation of a translator between a virtual machine language and the Hack assembly language. A specification of each can be found on the [Nand to Tetris website](https://www.nand2tetris.org).

The translator is designed as a command line program that takes one or more files ending in `.vm` as input and generates as output a single `.asm` file. This `.asm` file may then be passed to an assembler which will handle the translation of the Hack language into binary, or it may be run directly in the CPU emulator supplied in the Nand to Tetris tool suite.

The `.vm` files this program is designed to operate on are intended to be generated by a compiler, but may also be created directly for fun or testing. The virtual machine is stack-based and looks something like:
```
push constant 1
push constant 1
add
```

The conceptual result of this code would result in a single number 2 at the top of the stack. The actual assembly language code which would realize this on a Hack computer, and the generated output of translating this `.vm` input would look something like this:

```
// push constant 1
@1
D=A
@SP
A=M
M=D
@SP
M=M+1 // push D

// push constant 1
@1
D=A
@SP
A=M
M=D
@SP
M=M+1 // push D

// add
@SP
M=M-1
A=M // pop
D=M
@SP
M=M-1
A=M // pop
D=D+M
@SP
A=M
M=D
@SP
M=M+1 // push D
```

## Usage
Download this repository and run the executable either from the root like `dart bin/vm_translator.dart MyFile.vm` or [add this program as a global package](https://dart.dev/tools/pub/cmd/pub-global#activating-a-package-on-your-local-machine).

If a path to a `.vm` file is passed to the program, as in the example above, only that file will be translated. Otherwise, if a path to a directory is passed, all `.vm` files in that directory and its subdirectories will be translated. If no argument is passed, the program will operate on the directory in which the command is run. These 3 ways of running the program are represented respectively below:

`dart bin/vm_translator.dart <path-to-file>`

`dart bin/vm_translator.dart <path-to-directory>`

`dart bin/vm_translator.dart`

## Testing
For a comprehensive albeit non-exhaustive testing suite, see [here](https://www.nand2tetris.org/project07) and [here](https://www.nand2tetris.org/project08).
